@model Instrutor
@{
    ViewData["Title"] = "Cadastro";
}

<div class="text-center">
    <h1 class="display-4">Cadastro</h1>
</div>

<form id="cadastroForm" asp-action="Cadastrar" method="post" asp-controller="Instrutor">
    @Html.Partial("_InstrutorForm", Model)
</form>

@section Scripts {
    <script>

        function submitForm() {
            
            const formData = {

                Nome: checkField(document.getElementById('Nome')),
                CPF: checkField(document.getElementById('CPF')),
                Telefone: checkField(document.getElementById('Telefone')),
                Email: checkField(document.getElementById('Email')),
                Login: checkField(document.getElementById('Login')),
                Senha: checkField(document.getElementById('Senha'))
            };

            if (!validateFormInstrutor(formData)) {
                alert("Não foi possível salvar as informações.");
                return;
             }


            fetch('/api/Instrutor', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
            })
            .then(response => {
                
                if(response.status === 400){
                    return response.text().then(text => {
                                alert(text);
                                throw new Error(text); 
                            });
                }
                return response.json();
            })
            .then(data => {
                window.location.href = '/Instrutor/Instrutores';
            })
            .catch(error => console.error('Error:', error));
        }
    </script>
}