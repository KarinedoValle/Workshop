@model Workshop
@{
    ViewData["Title"] = "Cadastro";
}

<div class="text-center">
    <h1 class="display-4">Cadastro</h1>
</div>

<form id="cadastroForm" asp-action="Post" method="post" asp-controller="Workshop">
    @Html.Partial("_WorkshopForm", Model)
</form>

@section Scripts {
    <script>

        function submitForm() {
            
            const dateFields = document.querySelectorAll('p[name="Datas"]');
            const dates = Array.from(dateFields).map(field => new Date(field.id).toISOString());
            const formData = {

                Nome: checkField(document.getElementById('Nome')),
                Descricao: checkField(document.getElementById('Descricao')),
                Datas: dates,
                Instrutor: {cpf : checkField(document.getElementById('Instrutor'))},
                CategoriaTexto: checkField(document.getElementById('CategoriaTexto')),
                ModalidadeTexto: checkField(document.getElementById('ModalidadeTexto')),
                StatusTexto: checkField(document.getElementById('StatusTexto'))
            };

            if (!validateFormWorkshop(formData)) {
                return;
             }


            fetch('/api/Workshop', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
            })
            .then(response => response.json())
            .then(data => {
                window.location.href = '/Home/Index';
            })
            .catch(error => console.error('Error:', error));
        }
    </script>
}